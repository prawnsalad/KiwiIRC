<script type="text/javascript">
    // File picker plugin
    // Author: https://github.com/pepijndevos/
    
    $script("//api.filepicker.io/v1/filepicker.js", function () {
        var network = melon.components.Network();
        var control = melon.components.ControlInput();

        filepicker.setKey("YOUR_API_KEY");

        function uploaded(files) {
            var area = $("#melon .controlbox textarea");

            for (var i = 0; files.length>i; i++) {
                var f = files[i];
                area.val(area.val() + " " + f.url + "+" + encodeURIComponent(f.filename));
            }
        }

        filepicker.makeDropPane($("#melon .panels")[0], { onSuccess: uploaded });

        var $icon = $("<a class=\"upload\" title=\"Send File\"><i class=\"fa fa-upload\"></i></a>");
        $icon.click(function () { filepicker.pickMultiple(uploaded); });

        control.addPluginIcon($icon);
    });
</script>
